<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DCVTC66 ‚Äî Chauffeur VTC √† Perpignan</title>
  <meta name="description" content="DCVTC66, chauffeur VTC √† Perpignan, propose des trajets fiables, confortables et ponctuels dans tout le d√©partement 66 et au-del√†. R√©servation simple et rapide." />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" type="image/png" href="LOGO DCVTC66.png">
</head>

<body>

  <!-- HEADER / HERO -->
  <header class="header">
    <div class="container header-inner">
      <div class="branding">
        <img src="LOGO DCVTC66.png" alt="Logo DCVTC66" class="logo">
        <h1 class="site-title">DCVTC66</h1>
        <p class="site-subtitle">Votre chauffeur VTC priv√© √† Perpignan et dans tout le 66</p>

        <div class="hero-badges">
          <span>‚úî Service 7j/7</span>
          <span>‚úî Chauffeur professionnel et ponctuel</span>
          <span>‚úî R√©servation simple et rapide</span>
        </div>

        <div class="hero-actions">
          <a href="tel:0663463716" class="btn-primary">üìû Appeler le chauffeur</a>
          <a href="https://wa.me/33663463716" target="_blank" class="btn-secondary">
            üí¨ WhatsApp
          </a>
          <a href="#reservation" class="btn-outline">üìù R√©server un trajet</a>
        </div>
      </div>
    </div>
  </header>

  <!-- NAV -->
  <nav class="nav">
    <div class="container nav-inner">
      <ul>
        <li><a href="#services">Services</a></li>
        <li><a href="#reservation">R√©servation & estimation</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- SERVICES -->
  <section id="services" class="section">
    <div class="container">
      <h2 class="section-title">Nos services</h2>
      <p class="section-intro">
        DCVTC66 vous accompagne pour tous vos d√©placements personnels et professionnels,
        dans tout le d√©partement des Pyr√©n√©es-Orientales et au-del√†.
      </p>

      <div class="grid">
        <article class="card">
          <h3>Transferts a√©roports</h3>
          <p>D√©placements vers Perpignan, Toulouse, Carcassonne, Montpellier ou Barcelone.</p>
        </article>

        <article class="card">
          <h3>Transferts gares</h3>
          <p>Prise en charge √† la gare de Perpignan, Narbonne et dans la r√©gion.</p>
        </article>

        <article class="card">
          <h3>D√©placements professionnels</h3>
          <p>Rendez-vous, s√©minaires, visites de clients ou missions ponctuelles.</p>
        </article>

        <article class="card">
          <h3>Mise √† disposition</h3>
          <p>Chauffeur pour √©v√©nements, mariages, soir√©es ou journ√©es compl√®tes.</p>
        </article>
      </div>
    </div>
  </section>

  <!-- R√âSERVATION + ESTIMATION -->
  <section id="reservation" class="section section-alt">
    <div class="container">
      <h2 class="section-title">R√©server un trajet</h2>
      <p class="section-intro">
        Remplissez ce formulaire : votre t√©l√©phone ouvrira automatiquement un SMS pr√™t √† √™tre envoy√©
        au chauffeur avec tous les d√©tails de votre trajet. Vous pouvez √©galement estimer le kilom√©trage,
        le temps de trajet et le tarif avant d‚Äôenvoyer.
      </p>

      <form id="reservation-form" class="form">
        <label>Nom
          <input type="text" name="Nom" required>
        </label>

        <label>T√©l√©phone
          <input type="tel" name="T√©l√©phone" required>
        </label>

        <label>Point de d√©part
          <input type="text" name="D√©part" placeholder="Ex : Gare de Perpignan" required>
        </label>

        <label>Destination
          <input type="text" name="Arrivee" placeholder="Ex : A√©roport Perpignan-Rivesaltes" required>
        </label>

        <label>Date et heure
          <input type="datetime-local" name="DateHeure" required>
        </label>

        <label>Commentaires (optionnel)
          <textarea name="Message" rows="4" placeholder="Ex : Nombre de passagers, bagages, si√®ge enfant..."></textarea>
        </label>

        <!-- ESTIMATION TARIFAIRE (OPTIONNELLE) -->
        <div id="estimation" class="tarif-estimate" style="margin-top: 2rem; border-radius: 16px; background: #ffffff; padding: 1.5rem; box-shadow: 0 8px 24px rgba(0,0,0,0.06);">
          <h3 style="margin-top:0; margin-bottom:0.5rem; font-size:1.2rem;">Estimation du trajet (optionnel)</h3>
          <p style="margin-top:0; margin-bottom:1rem; font-size:0.95rem; color:#555;">
            Utilise les champs <strong>Point de d√©part</strong> et <strong>Destination</strong> ci-dessus pour
            estimer le kilom√©trage, le temps de trajet et le tarif selon la grille DCVTC66.
          </p>

          <button type="button" id="btn-tarif" class="btn-secondary" style="margin-bottom:1rem;">
            Estimer le kilom√©trage, le temps et le tarif
          </button>

          <div id="erreur-tarif" style="
            display:none;
            margin-bottom:0.75rem;
            padding:0.75rem;
            border-radius:8px;
            background:#ffecec;
            color:#a40000;
            font-size:0.9rem;">
          </div>

          <div id="resultat-tarif" style="
            display:none;
            margin-bottom:0.75rem;
            padding:0.75rem;
            border-radius:8px;
            background:#f0f7ff;
            color:#1b3b68;
            font-size:0.95rem;">
          </div>

          <div class="map-wrapper" style="position:relative;width:100%;height:320px;border-radius:12px;overflow:hidden;">
            <div id="map" style="width:100%;height:100%;"></div>
            <div id="tarif-overlay" style="
              display:none;
              position:absolute;
              top:10px;
              left:10px;
              background:rgba(255,255,255,0.96);
              border-radius:10px;
              padding:10px 12px;
              box-shadow:0 4px 16px rgba(0,0,0,0.15);
              font-size:0.9rem;
              max-width:260px;
              line-height:1.4;">
            </div>
          </div>

          <p style="margin-top:0.75rem; font-size:0.8rem; color:#777;">
            Estimation fournie √† titre indicatif √† partir des donn√©es Google Maps. Le tarif final peut varier
            en fonction des conditions r√©elles de circulation et des demandes sp√©cifiques.
          </p>
        </div>

        <button type="submit" class="btn-primary btn-full" style="margin-top:1.5rem;">
          Envoyer la demande par SMS
        </button>
      </form>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="section">
    <div class="container">
      <h2 class="section-title">Contact</h2>

      <div class="contact-grid">
        <div>
          <p>üìû T√©l√©phone : <a href="tel:0663463716"><strong>06 63 46 37 16</strong></a></p>
          <p>üí¨ WhatsApp : <a href="https://wa.me/33663463716" target="_blank"><strong>Discuter sur WhatsApp</strong></a></p>
        </div>
        <div>
          <p>üìß Email : <strong>contact@dcvtc66.fr</strong></p>
          <p>üìç Bas√© √† Perpignan ‚Äî d√©placements dans tout le 66 et au-del√†.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      ¬© <span id="year"></span> DCVTC66 ‚Äî Chauffeur VTC √† Perpignan
    </div>
  </footer>

  <!-- BOUTONS FLOTTANTS -->
  <a href="tel:0663463716" class="fab fab-call" aria-label="Appeler DCVTC66">
    üìû
  </a>

  <a href="https://wa.me/33663463716" target="_blank" class="fab fab-whatsapp" aria-label="WhatsApp DCVTC66">
    üí¨
  </a>

  <!-- JS : SMS -->
  <script>
    // Ann√©e automatique dans le footer
    document.getElementById("year").textContent = new Date().getFullYear();

    // Envoi du formulaire par SMS
    const form = document.getElementById('reservation-form');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const nom = form.Nom.value;
      const tel = form["T√©l√©phone"].value;
      const depart = form["D√©part"].value;
      const arrivee = form["Arrivee"].value;
      const dateHeure = form["DateHeure"].value;
      const messageClient = form["Message"].value;

      let sms = "Nouvelle demande de r√©servation DCVTC66 :\n\n";
      sms += "Nom : " + nom + "\n";
      sms += "T√©l√©phone : " + tel + "\n";
      sms += "D√©part : " + depart + "\n";
      sms += "Destination : " + arrivee + "\n";
      sms += "Date & heure : " + dateHeure + "\n";
      if (messageClient.trim() !== "") {
        sms += "Commentaires : " + messageClient + "\n";
      }

      const numero = "0663463716";
      const url = "sms:" + numero + "?&body=" + encodeURIComponent(sms);
      window.location.href = url;
    });
  </script>

  <!-- JS : Google Maps / Autocomplete / Distance / Temps / Tarif -->
  <script>
    const BASE_KM = 7;
    const BASE_TARIF = 20;      // 0 √† 7 km = 20 ‚Ç¨
    const SUPP_PAR_KM = 1.60;   // au-del√† : 1,60 ‚Ç¨/km

    let map;
    let distanceService;
    let directionsService;
    let directionsRenderer;

    // Appel√© automatiquement par Google Maps (callback=initMap)
    function initMap() {
      const mapElement = document.getElementById("map");
      if (!mapElement) {
        console.error("√âl√©ment #map introuvable.");
        return;
      }

      map = new google.maps.Map(mapElement, {
        center: { lat: 42.6986, lng: 2.8956 }, // Perpignan
        zoom: 11,
      });

      distanceService = new google.maps.DistanceMatrixService();
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: false
      });

      // AUTOCOMPL√âTION GOOGLE PLACES SUR LES CHAMPS DU FORMULAIRE
      const inputDepart = document.querySelector('input[name="D√©part"]');
      const inputArrivee = document.querySelector('input[name="Arrivee"]');

      if (inputDepart) {
        new google.maps.places.Autocomplete(inputDepart, {
          types: ['geocode'],
          componentRestrictions: { country: 'fr' }
        });
      }

      if (inputArrivee) {
        new google.maps.places.Autocomplete(inputArrivee, {
          types: ['geocode'],
          componentRestrictions: { country: 'fr' }
        });
      }

      const btnTarif = document.getElementById("btn-tarif");
      if (btnTarif) {
        btnTarif.addEventListener("click", calculerTarif);
      } else {
        console.error("Bouton #btn-tarif introuvable.");
      }
    }

    function calculerTarif() {
      const resDiv = document.getElementById("resultat-tarif");
      const errDiv = document.getElementById("erreur-tarif");
      const overlay = document.getElementById("tarif-overlay");

      const depart = form["D√©part"].value.trim();
      const arrivee = form["Arrivee"].value.trim();

      // Reset affichages
      errDiv.style.display = "none";
      errDiv.textContent = "";
      resDiv.style.display = "none";
      resDiv.textContent = "";
      overlay.style.display = "none";
      overlay.textContent = "";

      if (!depart || !arrivee) {
        errDiv.textContent = "Merci de renseigner le point de d√©part et la destination dans le formulaire.";
        errDiv.style.display = "block";
        return;
      }

      // Message pendant le calcul
      resDiv.style.display = "block";
      resDiv.innerHTML = "Calcul de l&#39;itin√©raire en cours...";

      distanceService.getDistanceMatrix(
        {
          origins: [depart],
          destinations: [arrivee],
          travelMode: google.maps.TravelMode.DRIVING,
          unitSystem: google.maps.UnitSystem.METRIC,
        },
        (response, status) => {
          if (status !== "OK") {
            console.error("DistanceMatrix error:", status, response);
            resDiv.style.display = "none";
            errDiv.textContent = "Erreur Google Maps : " + status;
            errDiv.style.display = "block";
            return;
          }

          const element = response.rows[0].elements[0];
          if (element.status !== "OK") {
            console.error("Element status:", element.status);
            resDiv.style.display = "none";
            errDiv.textContent = "Distance introuvable pour ces adresses. V√©rifiez l&#39;orthographe.";
            errDiv.style.display = "block";
            return;
          }

          const distanceMetres = element.distance.value; // en m√®tres
          let distanceKm = distanceMetres / 1000;
          distanceKm = Math.round(distanceKm * 10) / 10; // 0,1 km

          const dureeTexte = element.duration.text; // ex : "25 min"

          // Calcul tarif
          let tarif = BASE_TARIF;
          if (distanceKm > BASE_KM) {
            const kmSupp = distanceKm - BASE_KM;
            tarif += kmSupp * SUPP_PAR_KM;
          }
          tarif = Math.round(tarif * 100) / 100; // 2 d√©cimales

          // Texte d√©taill√© sous le formulaire
          resDiv.innerHTML =
            "Distance estim√©e : <strong>" + distanceKm + " km</strong><br>" +
            "Temps de trajet estim√© : <strong>" + dureeTexte + "</strong><br>" +
            "Tarif estim√© : <strong>" + tarif.toFixed(2) + " ‚Ç¨</strong><br><br>" +
            "<em>(Estimation calcul√©e avec l&#39;API Google Maps, trajet routier.)</em>";

          // Overlay sur la carte
          overlay.innerHTML =
            "<strong>Estimation trajet</strong><br>" +
            "Distance : " + distanceKm + " km<br>" +
            "Dur√©e : " + dureeTexte + "<br>" +
            "Tarif : " + tarif.toFixed(2) + " ‚Ç¨";
          overlay.style.display = "block";

          // Trac√© de l'itin√©raire sur la carte
          if (directionsService && directionsRenderer) {
            directionsService.route(
              {
                origin: depart,
                destination: arrivee,
                travelMode: google.maps.TravelMode.DRIVING,
              },
              (result, statusDir) => {
                if (statusDir === "OK") {
                  directionsRenderer.setDirections(result);
                } else {
                  console.warn("Directions error:", statusDir);
                }
              }
            );
          }
        }
      );
    }
  </script>

  <!-- GOOGLE MAPS API
       ‚ö†Ô∏è REMPLACE VOTRE_CLE_API_ICI PAR TA CL√â S√âCURIS√âE
       (et v√©rifie que Places API est bien activ√©e dans la console Google Cloud)
  -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDW4LNM6rw5DKJ3KjMP1hEvk03k5pCKg4c&callback=initMap&libraries=places" async defer></script>

</body>
</html>
