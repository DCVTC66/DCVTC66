<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DCVTC66 ‚Äî Chauffeur VTC √† Perpignan</title>
  <meta name="description" content="DCVTC66, chauffeur VTC √† Perpignan, propose des trajets fiables, confortables et ponctuels dans tout le d√©partement 66 et au-del√†. R√©servation simple et rapide." />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <link rel="icon" type="image/png" href="LOGO DCVTC66.png">

  <!-- STYLES COMPLETS -->
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
    }

    body {
      font-family: 'Poppins', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #111827;
      background-color: #f3f4f6;
      line-height: 1.5;
    }

    img {
      max-width: 100%;
      display: block;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .container {
      max-width: 1080px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    /* HEADER / HERO */
    .header {
      background: radial-gradient(circle at top left, #111827, #020617);
      color: #f9fafb;
      padding: 2.5rem 0 3rem;
    }

    .header-inner {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      min-height: 220px;
    }

    .branding {
      max-width: 560px;
    }

    .logo {
      height: 70px;
      width: auto;
      margin-bottom: 1rem;
    }

    .site-title {
      font-family: 'Playfair Display', serif;
      font-size: 2.4rem;
      letter-spacing: 0.04em;
      margin-bottom: 0.25rem;
    }

    .site-subtitle {
      font-size: 1rem;
      font-weight: 300;
      color: #e5e7eb;
      margin-bottom: 1.5rem;
    }

    .hero-badges {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
    }

    .hero-badges span {
      font-size: 0.85rem;
      background: rgba(15,23,42,0.7);
      border-radius: 999px;
      padding: 0.4rem 0.8rem;
      border: 1px solid rgba(148,163,184,0.4);
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 0.5rem;
    }

    /* NAV */
    .nav {
      background: #0f172a;
      color: #e5e7eb;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .nav-inner {
      display: flex;
      justify-content: center;
    }

    .nav ul {
      list-style: none;
      display: flex;
      gap: 1.5rem;
      padding: 0.75rem 0;
      font-size: 0.95rem;
    }

    .nav a {
      position: relative;
      padding-bottom: 0.15rem;
    }

    .nav a::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: -2px;
      width: 0;
      height: 2px;
      background: #facc15;
      transition: width 0.2s ease;
    }

    .nav a:hover::after {
      width: 100%;
    }

    /* SECTIONS */
    .section {
      padding: 2.5rem 0;
    }

    .section-alt {
      background: #f9fafb;
    }

    .section-title {
      font-family: 'Playfair Display', serif;
      font-size: 1.7rem;
      margin-bottom: 0.75rem;
      text-align: center;
      color: #111827;
    }

    .section-intro {
      max-width: 620px;
      margin: 0 auto 2rem;
      text-align: center;
      font-size: 0.98rem;
      color: #4b5563;
    }

    /* GRID SERVICES */
    .grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 1.25rem;
    }

    .card {
      background: #ffffff;
      border-radius: 0.9rem;
      padding: 1.25rem 1.2rem;
      box-shadow: 0 10px 25px rgba(15,23,42,0.06);
      border: 1px solid #e5e7eb;
    }

    .card h3 {
      font-size: 1rem;
      margin-bottom: 0.4rem;
      color: #111827;
    }

    .card p {
      font-size: 0.9rem;
      color: #4b5563;
    }

    /* FORMULAIRE */
    .form {
      background: #ffffff;
      border-radius: 1.1rem;
      padding: 1.75rem 1.5rem;
      box-shadow: 0 12px 30px rgba(15,23,42,0.06);
      border: 1px solid #e5e7eb;
    }

    .form label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 1rem;
      color: #111827;
    }

    .form input,
    .form textarea {
      width: 100%;
      margin-top: 0.35rem;
      padding: 0.55rem 0.7rem;
      border-radius: 0.5rem;
      border: 1px solid #d1d5db;
      font-family: inherit;
      font-size: 0.94rem;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease, background 0.15s ease;
      background-color: #f9fafb;
    }

    .form input:focus,
    .form textarea:focus {
      border-color: #0f766e;
      box-shadow: 0 0 0 1px rgba(15,118,110,0.35);
      background-color: #ffffff;
    }

    .form textarea {
      resize: vertical;
      min-height: 80px;
    }

    /* BOUTONS G√âN√âRAUX */
    .btn-primary,
    .btn-secondary,
    .btn-outline {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      padding: 0.8rem 1.4rem;
      border-radius: 999px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      border: 1px solid transparent;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease, color 0.15s ease;
      text-decoration: none;
      white-space: nowrap;
    }

    .btn-primary {
      background: #facc15;
      color: #111827;
      box-shadow: 0 10px 25px rgba(234,179,8,0.4);
    }

    .btn-primary:hover {
      background: #eab308;
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(234,179,8,0.6);
    }

    .btn-secondary {
      background: #0f172a;
      color: #e5e7eb;
      border-color: #1f2937;
    }

    .btn-secondary:hover {
      background: #020617;
      transform: translateY(-1px);
    }

    .btn-outline {
      background: transparent;
      color: #e5e7eb;
      border-color: rgba(249,250,251,0.7);
    }

    .btn-outline:hover {
      background: rgba(15,23,42,0.8);
      transform: translateY(-1px);
    }

    .btn-full {
      width: 100%;
    }

    /* BOUTON D'ESTIMATION MODERNIS√â */
    .btn-estimate {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.9rem 1.6rem;
      border-radius: 999px;
      font-weight: 600;
      font-size: 0.95rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      background: linear-gradient(135deg, #111827, #1f2933);
      color: #ffffff;
      border: none;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.35);
      transition: transform 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
      white-space: nowrap;
    }

    .btn-estimate span.icon {
      font-size: 1.15rem;
    }

    .btn-estimate:hover {
      transform: translateY(-1px) scale(1.01);
      box-shadow: 0 14px 30px rgba(15, 23, 42, 0.45);
      background: linear-gradient(135deg, #0b1120, #111827);
    }

    .btn-estimate:active {
      transform: translateY(0) scale(0.99);
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.35);
    }

    .form-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .form-actions button {
      flex: 1 1 180px;
    }

    /* CONTACT */
    .contact-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      font-size: 0.95rem;
      color: #374151;
    }

    .contact-grid p + p {
      margin-top: 0.35rem;
    }

    /* MAP SECTION */
    .map-wrapper {
      margin-top: 1rem;
      border-radius: 1rem;
      overflow: hidden;
      box-shadow: 0 14px 35px rgba(15,23,42,0.15);
      border: 1px solid #e5e7eb;
      background: #000;
    }

    /* FOOTER */
    .footer {
      background: #020617;
      color: #9ca3af;
      font-size: 0.85rem;
      padding: 1rem 0;
      text-align: center;
      margin-top: 1rem;
    }

    /* FAB BOUTONS FLOTTANTS TEL / WHATSAPP */
    .fab {
      position: fixed;
      bottom: 1.25rem;
      width: 46px;
      height: 46px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      color: #f9fafb;
      box-shadow: 0 16px 35px rgba(15,23,42,0.45);
      z-index: 60;
      text-decoration: none;
    }

    .fab-call {
      right: 1.25rem;
      background: #111827;
    }

    .fab-whatsapp {
      right: 4.25rem;
      background: #16a34a;
    }

    @media (max-width: 640px) {
      .fab-whatsapp {
        right: 1.25rem;
        bottom: 4.2rem;
      }
    }

    /* TARIF FLOTTANT TR√àS VISIBLE + ANIMATION */
    #tarif-flottant {
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 9999;
      display: none;
      align-items: center;
      gap: 0.75rem;
      padding: 0.9rem 1.3rem;
      border-radius: 999px;
      background: linear-gradient(135deg, #16a34a, #22c55e);
      color: #022c22;
      box-shadow: 0 16px 40px rgba(22, 163, 74, 0.7);
      font-size: 0.95rem;
      font-weight: 600;
      max-width: 90vw;
      border: 1px solid rgba(6, 95, 70, 0.75);
      animation: pulseTarif 1.6s ease-in-out infinite;
    }

    #tarif-flottant .icon {
      font-size: 1.3rem;
    }

    @media (max-width: 768px) {
      #tarif-flottant {
        left: 16px;
        right: 16px;
        bottom: 16px;
        justify-content: center;
      }
    }

    @keyframes pulseTarif {
      0% {
        transform: scale(1);
        box-shadow: 0 12px 30px rgba(22, 163, 74, 0.55);
      }
      50% {
        transform: scale(1.06);
        box-shadow: 0 18px 45px rgba(22, 163, 74, 0.85);
      }
      100% {
        transform: scale(1);
        box-shadow: 0 12px 30px rgba(22, 163, 74, 0.55);
      }
    }

    /* RESPONSIVE */
    @media (max-width: 900px) {
      .grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (max-width: 640px) {
      .header-inner {
        min-height: auto;
      }

      .grid {
        grid-template-columns: 1fr;
      }

      .form {
        padding: 1.4rem 1.1rem;
      }

      .hero-actions {
        flex-direction: column;
      }
    }
  </style>
</head>

<body>

  <!-- HEADER / HERO -->
  <header class="header">
    <div class="container header-inner">
      <div class="branding">
        <img src="LOGO DCVTC66.png" alt="Logo DCVTC66" class="logo">
        <h1 class="site-title">DCVTC66</h1>
        <p class="site-subtitle">Votre chauffeur VTC priv√© √† Perpignan et dans tout le 66</p>

        <div class="hero-badges">
          <span>‚úî Service 7j/7</span>
          <span>‚úî Chauffeur professionnel et ponctuel</span>
          <span>‚úî R√©servation simple et rapide</span>
        </div>

        <div class="hero-actions">
          <a href="tel:0663463716" class="btn-primary">üìû Appeler le chauffeur</a>
          <a href="https://wa.me/33663463716" target="_blank" class="btn-secondary">
            üí¨ WhatsApp
          </a>
          <a href="#reservation" class="btn-outline">üìù R√©server un trajet</a>
        </div>
      </div>
    </div>
  </header>

  <!-- NAV -->
  <nav class="nav">
    <div class="container nav-inner">
      <ul>
        <li><a href="#services">Services</a></li>
        <li><a href="#reservation">R√©servation & estimation</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </div>
  </nav>

  <!-- SERVICES -->
  <section id="services" class="section">
    <div class="container">
      <h2 class="section-title">Nos services</h2>
      <p class="section-intro">
        DCVTC66 vous accompagne pour tous vos d√©placements personnels et professionnels,
        dans tout le d√©partement des Pyr√©n√©es-Orientales et au-del√†.
      </p>

      <div class="grid">
        <article class="card">
          <h3>Transferts a√©roports</h3>
          <p>D√©placements vers Perpignan, Toulouse, Carcassonne, Montpellier ou Barcelone.</p>
        </article>

        <article class="card">
          <h3>Transferts gares</h3>
          <p>Prise en charge √† la gare de Perpignan, Narbonne et dans la r√©gion.</p>
        </article>

        <article class="card">
          <h3>D√©placements professionnels</h3>
          <p>Rendez-vous, s√©minaires, visites de clients ou missions ponctuelles.</p>
        </article>

        <article class="card">
          <h3>Mise √† disposition</h3>
          <p>Chauffeur pour √©v√©nements, mariages, soir√©es ou journ√©es compl√®tes.</p>
        </article>
      </div>
    </div>
  </section>

  <!-- R√âSERVATION + ESTIMATION -->
  <section id="reservation" class="section section-alt">
    <div class="container">
      <h2 class="section-title">R√©server un trajet</h2>
      <p class="section-intro">
        Remplissez le formulaire ci-dessous : votre t√©l√©phone g√©n√©rera automatiquement un SMS pr√©rempli
        √† destination de votre chauffeur, avec l‚Äôensemble des informations n√©cessaires √† votre prise en charge.
        Vous pouvez √©galement simuler le kilom√©trage, la dur√©e estim√©e et le tarif de votre course avant l‚Äôenvoi.
      </p>

      <form id="reservation-form" class="form">
        <label>Nom
          <input type="text" name="Nom" required>
        </label>

        <label>T√©l√©phone
          <input type="tel" name="T√©l√©phone" required>
        </label>

        <label>Point de d√©part
          <input type="text" name="D√©part" placeholder="Ex : Gare de Perpignan" required>
        </label>

        <label>Destination
          <input type="text" name="Arrivee" placeholder="Ex : A√©roport Perpignan-Rivesaltes" required>
        </label>

        <label>Date et heure
          <input type="datetime-local" name="DateHeure" required>
        </label>

        <label>Commentaires (optionnel)
          <textarea name="Message" rows="4" placeholder="Ex : Nombre de passagers, bagages, si√®ge enfant..."></textarea>
        </label>

        <!-- Bloc info estimation -->
        <div id="estimation" class="tarif-estimate" style="margin-top: 1.5rem; border-radius: 16px; background: #ffffff; padding: 1.2rem; box-shadow: 0 6px 18px rgba(0,0,0,0.05);">
          <h3 style="margin-top:0; margin-bottom:0.5rem; font-size:1.1rem;">Simulation de tarif (optionnel)</h3>

          <div id="erreur-tarif" style="
            display:none;
            margin-bottom:0.75rem;
            padding:0.75rem;
            border-radius:8px;
            background:#ffecec;
            color:#a40000;
            font-size:0.9rem;">
          </div>

          <div id="resultat-tarif" style="
            display:none;
            margin-bottom:0.25rem;
            padding:0.75rem;
            border-radius:8px;
            background:#f0f7ff;
            color:#1b3b68;
            font-size:0.95rem;">
          </div>

          <p style="margin-top:0.4rem; font-size:0.8rem; color:#777;">
            Estimation fournie √† titre indicatif. Le tarif final pourra varier en fonction des conditions r√©elles et des demandes sp√©cifiques.
          </p>
        </div>

        <!-- BOUTONS ENSEMBLE SOUS LE FORMULAIRE -->
        <div class="form-actions">
          <button
            type="button"
            id="btn-tarif"
            class="btn-estimate">
            <span class="icon">‚ú®</span>
            <span>Estimer le tarif</span>
          </button>

          <button type="submit" class="btn-primary btn-full">
            Envoyer ma demande
          </button>
        </div>
      </form>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="section">
    <div class="container">
      <h2 class="section-title">Contact</h2>

      <div class="contact-grid">
        <div>
          <p>üìû T√©l√©phone : <a href="tel:0663463716"><strong>06 63 46 37 16</strong></a></p>
          <p>üí¨ WhatsApp : <a href="https://wa.me/33663463716" target="_blank"><strong>Discuter sur WhatsApp</strong></a></p>
        </div>
        <div>
          <p>üìß Email : <strong>contact@dcvtc66.fr</strong></p>
          <p>üìç Bas√© √† Perpignan ‚Äî d√©placements dans tout le 66 et au-del√†.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- SECTION MAP TOUT EN BAS DE LA PAGE -->
  <section id="itineraire" class="section">
    <div class="container">
      <h2 class="section-title">Carte du trajet estim√©</h2>
      <p class="section-intro">
        La carte ci-dessous affiche l‚Äôitin√©raire et les informations principales apr√®s une estimation de votre trajet.
      </p>

      <div class="map-wrapper">
        <div id="map" style="width:100%;height:320px;"></div>
        <div id="tarif-overlay" style="
          display:none;
          position:absolute;
          top:10px;
          left:10px;
          background:rgba(255,255,255,0.96);
          border-radius:10px;
          padding:10px 12px;
          box-shadow:0 4px 16px rgba(0,0,0,0.15);
          font-size:0.9rem;
          max-width:260px;
          line-height:1.4;">
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      ¬© <span id="year"></span> DCVTC66 ‚Äî Chauffeur VTC √† Perpignan
    </div>
  </footer>

  <!-- BOUTONS FLOTTANTS -->
  <a href="tel:0663463716" class="fab fab-call" aria-label="Appeler DCVTC66">
    üìû
  </a>

  <a href="https://wa.me/33663463716" target="_blank" class="fab fab-whatsapp" aria-label="WhatsApp DCVTC66">
    üí¨
  </a>

  <!-- AFFICHAGE TARIF FLOTTANT -->
  <div id="tarif-flottant">
    <span class="icon">üí∞</span>
    <span id="tarif-flottant-texte">Estimation en cours‚Ä¶</span>
  </div>

  <!-- JS : SMS -->
  <script>
    // Ann√©e automatique dans le footer
    document.getElementById("year").textContent = new Date().getFullYear();

    // Variable globale pour stocker la derni√®re estimation
    let derniereEstimation = null;

    // Envoi du formulaire par SMS
    const form = document.getElementById('reservation-form');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const nom = form.Nom.value;
      const tel = form["T√©l√©phone"].value;
      const depart = form["D√©part"].value;
      const arrivee = form["Arrivee"].value;
      const dateHeure = form["DateHeure"].value;
      const messageClient = form["Message"].value;

      let sms = "Nouvelle demande de r√©servation ‚Äì DCVTC66 :\n\n";
      sms += "Nom : " + nom + "\n";
      sms += "T√©l√©phone : " + tel + "\n";
      sms += "D√©part : " + depart + "\n";
      sms += "Destination : " + arrivee + "\n";
      sms += "Date & heure : " + dateHeure + "\n";
      if (messageClient.trim() !== "") {
        sms += "Commentaires : " + messageClient + "\n";
      }

      // Ajout de l'estimation si disponible
      if (derniereEstimation) {
        sms += "\n--- Estimation indicative ---\n";
        sms += "Distance : " + derniereEstimation.distanceKm + " km\n";
        sms += "Dur√©e : " + derniereEstimation.dureeTexte + "\n";
        sms += "Tarif estim√© : " + derniereEstimation.tarif.toFixed(2) + " ‚Ç¨\n";
      }

      const numero = "0663463716";
      const url = "sms:" + numero + "?&body=" + encodeURIComponent(sms);
      window.location.href = url;
    });
  </script>

  <!-- JS : Google Maps / Autocomplete / Distance / Temps / Tarif -->
  <script>
    const BASE_KM = 7;
    const BASE_TARIF = 20;      // 0 √† 7 km = 20 ‚Ç¨
    const SUPP_PAR_KM = 1.60;   // au-del√† : 1,60 ‚Ç¨/km

    let map;
    let distanceService;
    let directionsService;
    let directionsRenderer;

    // Appel√© automatiquement par Google Maps (callback=initMap)
    function initMap() {
      const mapElement = document.getElementById("map");
      if (!mapElement) {
        console.error("√âl√©ment #map introuvable.");
        return;
      }

      map = new google.maps.Map(mapElement, {
        center: { lat: 42.6986, lng: 2.8956 }, // Perpignan
        zoom: 11,
      });

      distanceService = new google.maps.DistanceMatrixService();
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer({
        map: map,
        suppressMarkers: false
      });

      // AUTOCOMPL√âTION GOOGLE PLACES SUR LES CHAMPS DU FORMULAIRE
      const inputDepart = document.querySelector('input[name="D√©part"]');
      const inputArrivee = document.querySelector('input[name="Arrivee"]');

      if (inputDepart) {
        new google.maps.places.Autocomplete(inputDepart, {
          types: ['geocode'],
          componentRestrictions: { country: 'fr' }
        });
      }

      if (inputArrivee) {
        new google.maps.places.Autocomplete(inputArrivee, {
          types: ['geocode'],
          componentRestrictions: { country: 'fr' }
        });
      }

      const btnTarif = document.getElementById("btn-tarif");
      if (btnTarif) {
        btnTarif.addEventListener("click", calculerTarif);
      } else {
        console.error("Bouton #btn-tarif introuvable.");
      }
    }

    function calculerTarif() {
      const resDiv = document.getElementById("resultat-tarif");
      const errDiv = document.getElementById("erreur-tarif");
      const overlay = document.getElementById("tarif-overlay");
      const flottant = document.getElementById("tarif-flottant");
      const flottantTexte = document.getElementById("tarif-flottant-texte");

      const depart = form["D√©part"].value.trim();
      const arrivee = form["Arrivee"].value.trim();

      // Reset affichages
      errDiv.style.display = "none";
      errDiv.textContent = "";
      resDiv.style.display = "none";
      resDiv.textContent = "";
      overlay.style.display = "none";
      overlay.textContent = "";
      if (flottant) {
        flottant.style.display = "none";
      }

      if (!depart || !arrivee) {
        errDiv.textContent = "Veuillez renseigner le point de d√©part et la destination dans le formulaire.";
        errDiv.style.display = "block";
        return;
      }

      // Message pendant le calcul
      resDiv.style.display = "block";
      resDiv.innerHTML = "Calcul de l&#39;itin√©raire en cours...";

      distanceService.getDistanceMatrix(
        {
          origins: [depart],
          destinations: [arrivee],
          travelMode: google.maps.TravelMode.DRIVING,
          unitSystem: google.maps.UnitSystem.METRIC,
        },
        (response, status) => {
          if (status !== "OK") {
            console.error("DistanceMatrix error:", status, response);
            resDiv.style.display = "none";
            errDiv.textContent = "Erreur Google Maps : " + status;
            errDiv.style.display = "block";
            return;
          }

          const element = response.rows[0].elements[0];
          if (element.status !== "OK") {
            console.error("Element status:", element.status);
            resDiv.style.display = "none";
            errDiv.textContent = "Distance introuvable pour ces adresses. Veuillez v√©rifier l&#39;orthographe ou pr√©ciser la commune.";
            errDiv.style.display = "block";
            return;
          }

          const distanceMetres = element.distance.value; // en m√®tres
          let distanceKm = distanceMetres / 1000;
          distanceKm = Math.round(distanceKm * 10) / 10; // 0,1 km

          const dureeTexte = element.duration.text; // ex : "25 min"

          // Calcul tarif
          let tarif = BASE_TARIF;
          if (distanceKm > BASE_KM) {
            const kmSupp = distanceKm - BASE_KM;
            tarif += kmSupp * SUPP_PAR_KM;
          }
          tarif = Math.round(tarif * 100) / 100; // 2 d√©cimales

          // Stockage global pour l'ajout dans le SMS
          derniereEstimation = {
            distanceKm: distanceKm,
            dureeTexte: dureeTexte,
            tarif: tarif
          };

          // Texte d√©taill√© sous le formulaire
          resDiv.innerHTML =
            "Distance estim√©e : <strong>" + distanceKm + " km</strong><br>" +
            "Temps de trajet estim√© : <strong>" + dureeTexte + "</strong><br>" +
            "Tarif estim√© (indicatif) : <strong>" + tarif.toFixed(2) + " ‚Ç¨</strong><br><br>" +
            "<em>(Estimation bas√©e sur l&#39;API Google Maps, pour un trajet routier standard.)</em>";

          resDiv.style.display = "block";

          // Overlay sur la carte (section du bas)
          overlay.innerHTML =
            "<strong>Simulation de votre trajet</strong><br>" +
            "Distance : " + distanceKm + " km<br>" +
            "Dur√©e : " + dureeTexte + "<br>" +
            "Tarif estimatif : " + tarif.toFixed(2) + " ‚Ç¨";
          overlay.style.display = "block";

          // Affichage flottant du tarif ‚Äì bien visible
          if (flottant && flottantTexte) {
            flottantTexte.textContent =
              "Estimation : " + tarif.toFixed(2) + " ‚Ç¨ ‚Ä¢ " +
              distanceKm + " km ‚Ä¢ " + dureeTexte;
            flottant.style.display = "flex";
          }

          // Trac√© de l'itin√©raire sur la carte
          if (directionsService && directionsRenderer) {
            directionsService.route(
              {
                origin: depart,
                destination: arrivee,
                travelMode: google.maps.TravelMode.DRIVING,
              },
              (result, statusDir) => {
                if (statusDir === "OK") {
                  directionsRenderer.setDirections(result);
                } else {
                  console.warn("Directions error:", statusDir);
                }
              }
            );
          }
        }
      );
    }
  </script>

  <!-- GOOGLE MAPS API (garde ta cl√©, tu peux la changer dans la console Google) -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDW4LNM6rw5DKJ3KjMP1hEvk03k5pCKg4c&callback=initMap&libraries=places" async defer></script>

</body>
</html>
